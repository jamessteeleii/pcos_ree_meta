country,
-c(m_age, sd_age,
m_body_mass, sd_body_mass,
m_height, sd_height,
m_bmi, sd_bmi,
m_fat_mass, sd_fat_mass,
m_fat_free_mass, sd_fat_free_mass),
insulin_resistant_description,
method,
)|>
rename(
Authors = "authors",
`Article title` = "title",
`Country of study` = "country",
Condition = "cond",
`Diagnostic criteria` = diagnostic_criteria,
`Sample size` = "n",
`Race/Ethnicity` = "race",
`Physical activity` = "physical_activity_level",
`Metabolic health` = "insulin_resistant_description",
`Measurement Method` = "method"
) |>
mutate(year = as.numeric(year)) |>
arrange(year) |>
select(-year) |>
group_by(Authors) |>
mutate(
is_last_row = row_number() == n()
) |>
ungroup()
ft <- table |>
flextable() |>
hline(
j = setdiff(colnames(table), c("Authors", "Article title")),  # exclude the study col
border = officer::fp_border(color = "grey80", width = 0.4)
) |>
hline(
i = ~ is_last_row == TRUE,      # only where is_last_row == TRUE
border = officer::fp_border(color = "black")
) |>
bold(part = "header") |>
autofit() |>
fontsize(size = 8) |>
align(
j = c(
"Condition",
"Sample size",
"Age",
"Body mass",
"Height",
"BMI",
"Fat mass",
"Fat free mass",
"Race/Ethnicity",
"Country of study",
"Measurement Method"
),
align = "center",
part = "all"
) |>
width(j = NULL, width = 0.5) |>
delete_columns(j = "is_last_row") |>
merge_v(j = c("Authors", "Article title")) |>
footnote(
i = 1,
j = c(
"Authors", # just to add abbreviations to footnote with not symbol
"Age",
"Body mass",
"Height",
"BMI",
"Fat mass",
"Fat free mass"
),
value = as_paragraph(
c(
"PCOS = polycystic ovary syndrome; BMI = body mass index; OGTT = oral glucose tolerance test; HOMA-IR = homeostatic model assessment of insulin resistance",
"Values are Mean (SD) unless otherwise specified; note, some have been calculated/estimated from corresponding standard error, range, iqr, median, and sample size (see data and code)",
"Indicates that this mean was estimated from the corresponding means for body mass/height/BMI"
)
),
ref_symbols = c(" ", "†", "†*", "†*", "†*", "†", "†"),   # no superscript
part = "header"
)
ft |> font("lmodern")
ft |> font(fontname = "lmodern")
ft |> font(fontname = "lmodern", part = "all")
install.packages("webshot2")
targets::tar_make()
targets::tar_make()
targets::tar_make()
targets::tar_load(c(
descriptives_table_image,
main_arm_data_imputed_demographics
))
#| label: tbl-review
#| tbl-cap: Descriptive characteristics of arms and participants for included studies
# descriptives_table
knitr::include_graphics(descriptives_table_image)
descriptives_table_image
descriptives_table_image
?knitr::include_graphics
knitr::include_graphics(here::here("plots", "descriptives_table.svg"))
#| label: tbl-review
#| tbl-cap: Descriptive characteristics of arms and participants for included studies
# descriptives_table
knitr::include_graphics(path=descriptives_table_image)
#| label: tbl-review
#| tbl-cap: Descriptive characteristics of arms and participants for included studies
knitr::include_graphics(here::here("plots", "descriptives_table.svg"))
?flextable::width
29/16
targets::tar_make()
targets::tar_make()
targets::tar_make()
targets::tar_make()
targets::tar_make()
targets::tar_make()
targets::tar_load(descriptives_table)
descriptives_table
print(descriptives_table)
library(flextable)
print(descriptives_table)
targets::tar_make()
targets::tar_make()
targets::tar_make()
?line_spacing
targets::tar_make()
targets::tar_make()
knitr::include_graphics(here::here("tables", "descriptives_table.svg"))
targets::tar_make()
?knitr::include_graphics
#| label: tbl-review
#| tbl-cap: Descriptive characteristics of arms and participants for included studies
knitr::include_graphics(here::here("tables", "descriptives_table.png"), dpi = 300)
#| label: tbl-review
#| tbl-cap: Descriptive characteristics of arms and participants for included studies
#| fig-width: 10
knitr::include_graphics(here::here("tables", "descriptives_table.png"))
#| label: tbl-review
#| tbl-cap: Descriptive characteristics of arms and participants for included studies
#| fig-width: 20
knitr::include_graphics(here::here("tables", "descriptives_table.png"))
targets::tar_make()
#| label: tbl-review
#| tbl-cap: Descriptive characteristics of arms and participants for included studies
targets::tar_load(descriptives_table)
descriptives_table
?fontsize
targets::tar_make()
targets::tar_make()
targets::tar_make()
targets::tar_make()
descriptives_table |>
paginate(group = c("Authors", "Condition"))
descriptives_table |>
paginate(group = c("Authors", "Condition")) |>
autofit()
targets::tar_make()
#| label: tbl-review
#| tbl-cap: Descriptive characteristics of arms and participants for included studies
targets::tar_load(descriptives_table)
descriptives_table
dim(descriptives_table)$widths
auto_widths <- dim(descriptives_table)$widths/sum(dim(descriptives_table)$widths)
auto_widths
descriptives_table <- descriptives_table |>
descriptives_table
descriptives_table <- descriptives_table |>
autofit()
auto_widths <- dim(descriptives_table)$widths/sum(dim(descriptives_table)$widths)
auto_widths
descriptives_table |>
paginate(group = c("Authors", "Condition")) |>
width(width=w*auto_widths)
w = 9 # width of the borders in the pdf output
auto_widths <- dim(descriptives_table)$widths/sum(dim(descriptives_table)$widths)
descriptives_table |>
paginate(group = c("Authors", "Condition")) |>
width(width=w*auto_widths)
?width
w*auto_widths
ncol(descriptives_table)
descriptives_table |>
paginate(group = c("Authors", "Condition")) |>
width(width=w*auto_widths, unit = "in") |>
fontsize(size = 8, part = "header") |>
fontsize(size = 4, part = "footer") |>
fontsize(size = 4, part = "body")
sum(dim(descriptives_table)$widths
sum(dim(descriptives_table)$widths)
sum(dim(descriptives_table)$widths)
auto_widths
w*auto_widths
sum(w*auto_widths)
targets::tar_load(c(
main_arm_data_imputed_demographics
))
main_arm_data_imputed_demographics
View(main_arm_data_imputed_demographics)
length(unique(main_arm_data_imputed_demographics$study))
?save_as_image
16/7
7/16
descriptives_table$header
descriptives_table$header$col_keys
7/16
0.4375/4
0.4375/2
descriptives_table |>
width(
j = descriptives_table$header$col_keys,
width = c(
0.21875,
0.4375,
0.109375,
0.4375,
0.109375,
0.109375,
0.109375,
0.109375,
0.109375,
0.109375,
0.109375,
0.21875,
0.4375,
0.109375,
0.4375,
0.4375
)
)
sum(c(
0.21875,
0.4375,
0.109375,
0.4375,
0.109375,
0.109375,
0.109375,
0.109375,
0.109375,
0.109375,
0.109375,
0.21875,
0.4375,
0.109375,
0.4375,
0.4375
))
sum(c(
0.21875,
0.4375,
0.109375,
0.4375,
0.109375,
0.109375,
0.109375,
0.109375,
0.109375,
0.109375,
0.109375,
0.21875,
0.4375,
0.109375,
0.4375,
0.4375
)*2)
c(
0.21875,
0.4375,
0.109375,
0.4375,
0.109375,
0.109375,
0.109375,
0.109375,
0.109375,
0.109375,
0.109375,
0.21875,
0.4375,
0.109375,
0.4375,
0.4375
)*2
sum(c(
0.21875,
0.21875,
0.109375,
0.4375,
0.109375,
0.109375,
0.109375,
0.109375,
0.109375,
0.109375,
0.109375,
0.21875,
0.4375,
0.109375,
0.4375,
0.4375
)*2)
7/sum(c(
0.21875,
0.21875,
0.109375,
0.4375,
0.109375,
0.109375,
0.109375,
0.109375,
0.109375,
0.109375,
0.109375,
0.21875,
0.4375,
0.109375,
0.4375,
0.4375
))
targets::tar_make()
targets::tar_make()
targets::tar_make()
main_arm_data_imputed_demographics$method
View(main_arm_data_imputed_demographics)
library(tidyverse)
main_arm_data_imputed_demographics |> filter(method == "doubly_labelled_water")
main_arm_data_imputed_demographics |> filter(cond == "PCOS") |> group_by(arm) |> slice_head(n=1) |> count(insulin_resistant_y_n)
main_arm_data_imputed_demographics |> filter(cond == "PCOS") |> group_by(arm) |> slice_head(n=1) |> ungroup() |> count(insulin_resistant_y_n)
glimpse(main_arm_data_imputed_demographics)
min(main_arm_data_imputed_demographics$m_age)
max(main_arm_data_imputed_demographics$m_age)
targets::tar_make()
main_arm_data_imputed_demographics_baseline <- main_arm_data_imputed_demographics |>
filter(timepoint == "baseline")
no_conditions <- main_arm_data_imputed_demographics_baseline |>
group_by(cond) |>
count()
summary_descriptives <- main_arm_data_imputed_demographics_baseline |>
group_by(cond) |>
summarise(
min_age = min(m_age, na.rm = TRUE),
max_age = max(m_age, na.rm = TRUE)
)
summary_descriptives
summary_descriptives <- main_arm_data_imputed_demographics_baseline |>
group_by(cond) |>
summarise(
min_age = min(m_age, na.rm = TRUE),
max_age = max(m_age, na.rm = TRUE),
min_bmi = min(m_bmi, na.rm = TRUE),
max_bmi = max(m_bmi, na.rm = TRUE)
)
summary_descriptives
summary_descriptives <- main_arm_data_imputed_demographics_baseline |>
group_by(cond) |>
summarise(
min_age = round(min(m_age, na.rm = TRUE)),
max_age = round(max(m_age, na.rm = TRUE)),
min_bmi = round(min(m_bmi, na.rm = TRUE),2),
max_bmi = round(max(m_bmi, na.rm = TRUE),2)
) |>
```
summary_descriptives <- main_arm_data_imputed_demographics_baseline |>
group_by(cond) |>
summarise(
min_age = round(min(m_age, na.rm = TRUE)),
max_age = round(max(m_age, na.rm = TRUE)),
min_bmi = round(min(m_bmi, na.rm = TRUE),2),
max_bmi = round(max(m_bmi, na.rm = TRUE),2)
)
summary_descriptives
targets::tar_make()
targets::tar_make()
targets::tar_load(c(
c(main_arm_data_imputed_demographics,
main_plus_greek_arm_data_imputed_demographics)
))
main_plus_greek_arm_data_imputed_demographics
View(main_plus_greek_arm_data_imputed_demographics)
targets::tar_make()
targets::tar_make()
targets::tar_load(c(main_arm_data_effects, main_arm_data_imputed_demographics))
library(tidyverse)
main_arm_data_imputed_demographics <- escalc(measure = "MN",
mi = mean,
sdi = sd,
ni = n,
data = main_arm_data_imputed_demographics,
var.names = c("yi_mean", "vi_mean"))
library(metafor)
main_arm_data_imputed_demographics <- escalc(measure = "MN",
mi = mean,
sdi = sd,
ni = n,
data = main_arm_data_imputed_demographics,
var.names = c("yi_mean", "vi_mean"))
main_arm_data_imputed_demographics |>
ggplot(aes(x=m_body_mass, y=yi, colour = cond)) +
geom_point()
main_arm_data_imputed_demographics |>
ggplot(aes(x=m_body_mass, y=yi_mean, colour = cond)) +
geom_point()
ggplot(aes(x=m_body_mass, y=yi_mean, colour = cond)) +
geom_point(aes(size=size))
main_arm_data_imputed_demographics |>
mutate(
wi = 1/sqrt(vi_mean),
size = 0.5 + 3.0 * (wi - min(wi, na.rm=TRUE))/(max(wi, na.rm=TRUE) - min(wi, na.rm=TRUE))) |>
ggplot(aes(x=m_body_mass, y=yi_mean, colour = cond)) +
geom_point(aes(size=size))
View(main_arm_data_imputed_demographics)
main_arm_data_imputed_demographics |>
mutate(
wi = 1/sqrt(vi_mean),
size = 0.5 + 3.0 * (wi - min(wi, na.rm=TRUE))/(max(wi, na.rm=TRUE) - min(wi, na.rm=TRUE))) |>
ggplot(aes(x=m_bmi, y=yi_mean, colour = cond)) +
geom_point(aes(size=size)) +
scale_color_manual(values = c("#56B4E9", "#E69F00", "#009E73")) +
main_arm_data_imputed_demographics |>
mutate(
wi = 1/sqrt(vi_mean),
size = 0.5 + 3.0 * (wi - min(wi, na.rm=TRUE))/(max(wi, na.rm=TRUE) - min(wi, na.rm=TRUE))) |>
ggplot(aes(x=m_bmi, y=yi_mean, colour = cond)) +
geom_point(aes(size=size)) +
scale_color_manual(values = c("#56B4E9", "#E69F00", "#009E73"))
main_arm_data_imputed_demographics |>
mutate(
wi = 1/sqrt(vi_mean),
size = 0.5 + 3.0 * (wi - min(wi, na.rm=TRUE))/(max(wi, na.rm=TRUE) - min(wi, na.rm=TRUE))) |>
ggplot(aes(x=m_bmi, y=yi_mean, colour = cond)) +
geom_point(aes(size=size)) +
scale_color_manual(values = c("#56B4E9", "#E69F00", "#009E73"))
main_arm_data_imputed_demographics |>
mutate(
wi = 1/sqrt(vi_mean),
size = 0.5 + 3.0 * (wi - min(wi, na.rm=TRUE))/(max(wi, na.rm=TRUE) - min(wi, na.rm=TRUE))) |>
ggplot(aes(x=m_height, y=yi_mean, colour = cond)) +
geom_point(aes(size=size)) +
scale_color_manual(values = c("#56B4E9", "#E69F00", "#009E73"))
main_arm_data_imputed_demographics |>
mutate(
wi = 1/sqrt(vi_mean),
size = 0.5 + 3.0 * (wi - min(wi, na.rm=TRUE))/(max(wi, na.rm=TRUE) - min(wi, na.rm=TRUE))) |>
ggplot(aes(x=m_body_mass, y=yi_mean, colour = cond)) +
geom_point(aes(size=size)) +
scale_color_manual(values = c("#56B4E9", "#E69F00", "#009E73")) +
guides(
size = "none"
)
?rma.mv
rma.mv(yi, vi,
mods = m_body_mass*cond,
random = list( ~ 1 + cond | lab,  ~ 1 + cond | study, ~ 1 | arm, ~ 1 |effect),
data = main_arm_data_imputed_demographics,
method = "REML")
rma.mv(yi_mean, vi_mean,
mods = m_body_mass*cond,
random = list( ~ 1 + cond | lab,  ~ 1 + cond | study, ~ 1 | arm, ~ 1 |effect),
data = main_arm_data_imputed_demographics,
method = "REML")
rma.mv(yi_mean, vi_mean,
mods = ~ m_body_mass*cond,
random = list( ~ 1 + cond | lab,  ~ 1 + cond | study, ~ 1 | arm, ~ 1 |effect),
data = main_arm_data_imputed_demographics,
method = "REML")
meta_reg <- rma.mv(yi_mean, vi_mean,
mods = ~ m_body_mass*cond,
random = list( ~ 1 + cond | lab,  ~ 1 + cond | study, ~ 1 | arm, ~ 1 |effect),
data = main_arm_data_imputed_demographics,
method = "REML")
regplot(meta_reg)
?regplot
regplot(meta_reg, mod =  m_body_mass)
regplot(meta_reg, mod =  "m_body_mass")
main_arm_data_imputed_demographics |>
mutate(
wi = 1/sqrt(vi_mean),
size = 0.5 + 3.0 * (wi - min(wi, na.rm=TRUE))/(max(wi, na.rm=TRUE) - min(wi, na.rm=TRUE))) |>
ggplot(aes(x=m_body_mass, y=yi_mean, colour = cond)) +
geom_point(aes(size=size)) +
scale_color_manual(values = c("#56B4E9", "#E69F00", "#009E73")) +
guides(
size = "none"
)
main_arm_data_imputed_demographics |>
mutate(
wi = 1/sqrt(vi_mean),
size = 0.5 + 3.0 * (wi - min(wi, na.rm=TRUE))/(max(wi, na.rm=TRUE) - min(wi, na.rm=TRUE))) |>
ggplot(aes(x=m_body_mass, y=yi_mean, colour = cond)) +
geom_point(aes(size=size)) +
scale_color_manual(values = c("#56B4E9", "#E69F00", "#009E73")) +
guides(
size = "none"
) +
geom_smooth()
main_arm_data_imputed_demographics |>
mutate(
wi = 1/sqrt(vi_mean),
size = 0.5 + 3.0 * (wi - min(wi, na.rm=TRUE))/(max(wi, na.rm=TRUE) - min(wi, na.rm=TRUE))) |>
ggplot(aes(x=m_body_mass, y=yi_mean, colour = cond)) +
geom_point(aes(size=size)) +
scale_color_manual(values = c("#56B4E9", "#E69F00", "#009E73")) +
guides(
size = "none"
) +
geom_smooth(method = "lm")
targets::tar_load(main_plus_greek_arm_data)
View(main_plus_greek_arm_data)
targets::tar_visnetwork()
targets::tar_load(combined_mean_plot)
