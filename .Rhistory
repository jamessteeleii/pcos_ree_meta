) +
labs(
x = "Resting Energy Expenditure (kcal)",
title = "Conditional Estimates for Condition by Study"
) +
guides(
fill = "none",
color = "none"
) +
theme_bw() +
theme(axis.title.y = element_blank()) +
theme(title = element_text(size=8))
ggplot(study_pred, aes(x = draw,
y = reorder(study_label, mean_draw),
fill = cond)) +
stat_halfeye(slab_alpha = .5, point_size = 0.1, linewidth = 0.1,
position = position_dodge(width = 0.5), .width = 0.95) +
scale_fill_manual(values = c("#56B4E9", "#E69F00", "#009E73")) +
scale_color_manual(values = c("#56B4E9", "#E69F00", "#009E73")) +
geom_text(
data = mutate_if(study_labels,
is.numeric, round, 2),
aes(
label = glue::glue("{cond}: {round(draw)} [{round(.lower)}, {round(.upper)}]"),
x = 2250, y =reorder(study_label, draw), group = cond
),
size = 2, position = position_dodge(width = 0.75),
hjust = "inward"
) +
# Add individual study data
geom_point(
data = main_arm_data_effects |>
filter(!is.na(yi_mean)) |>
mutate(study_label = paste(authors, year)),
aes(x = yi_mean, y = study_label, color = cond),
size = 0.25,
alpha = 0.5,
position = position_jitterdodge(dodge.width = 0.5, jitter.height = 0.1)
# position = position_dodge(width = 0.75),
# shape = "|"
) +
labs(
x = "Resting Energy Expenditure (kcal)",
title = "Conditional Estimates for Condition by Study"
) +
guides(
fill = "none",
color = "none"
) +
theme_bw() +
theme(axis.title.y = element_blank()) +
theme(title = element_text(size=8))
ggplot(study_pred, aes(x = draw,
y = reorder(study_label, mean_draw),
fill = cond)) +
stat_halfeye(slab_alpha = .5, point_size = 0.1, linewidth = 0.1,
position = position_dodge(width = 0.5), .width = 0.95) +
scale_fill_manual(values = c("#56B4E9", "#E69F00", "#009E73")) +
scale_color_manual(values = c("#56B4E9", "#E69F00", "#009E73")) +
geom_text(
data = mutate_if(study_labels,
is.numeric, round, 2),
aes(
label = glue::glue("{cond}: {round(draw)} [{round(.lower)}, {round(.upper)}]"),
x = 2250, y =reorder(study_label, draw), group = cond
),
size = 2, position = position_dodge(width = 0.75),
hjust = "inward"
) +
# Add individual study data
geom_point(
data = main_arm_data_effects |>
filter(!is.na(yi_mean)) |>
mutate(study_label = paste(authors, year)),
aes(x = yi_mean, y = study_label, color = cond),
size = 0.25,
alpha = 0.5,
position = position_jitterdodge(dodge.width = 0.5, dodge.height = 0.1)
# position = position_dodge(width = 0.75),
# shape = "|"
) +
labs(
x = "Resting Energy Expenditure (kcal)",
title = "Conditional Estimates for Condition by Study"
) +
guides(
fill = "none",
color = "none"
) +
theme_bw() +
theme(axis.title.y = element_blank()) +
theme(title = element_text(size=8))
ggplot(study_pred, aes(x = draw,
y = reorder(study_label, mean_draw),
fill = cond)) +
stat_halfeye(slab_alpha = .5, point_size = 0.1, linewidth = 0.1,
position = position_dodge(width = 0.5), .width = 0.95) +
scale_fill_manual(values = c("#56B4E9", "#E69F00", "#009E73")) +
scale_color_manual(values = c("#56B4E9", "#E69F00", "#009E73")) +
geom_text(
data = mutate_if(study_labels,
is.numeric, round, 2),
aes(
label = glue::glue("{cond}: {round(draw)} [{round(.lower)}, {round(.upper)}]"),
x = 2250, y =reorder(study_label, draw), group = cond
),
size = 2, position = position_dodge(width = 0.75),
hjust = "inward"
) +
# Add individual study data
geom_point(
data = main_arm_data_effects |>
filter(!is.na(yi_mean)) |>
mutate(study_label = paste(authors, year)),
aes(x = yi_mean, y = study_label, color = cond),
size = 0.25,
# alpha = 0.5,
position = position_dodge(width = 0.5)
# position = position_dodge(width = 0.75),
# shape = "|"
) +
labs(
x = "Resting Energy Expenditure (kcal)",
title = "Conditional Estimates for Condition by Study"
) +
guides(
fill = "none",
color = "none"
) +
theme_bw() +
theme(axis.title.y = element_blank()) +
theme(title = element_text(size=8))
ggplot(study_pred, aes(x = draw,
y = reorder(study_label, mean_draw),
fill = cond)) +
stat_halfeye(slab_alpha = .5, point_size = 0.1, linewidth = 0.1,
position = position_dodge(width = 0.5), .width = 0.95) +
scale_fill_manual(values = c("#56B4E9", "#E69F00", "#009E73")) +
scale_color_manual(values = c("#56B4E9", "#E69F00", "#009E73")) +
geom_text(
data = mutate_if(study_labels,
is.numeric, round, 2),
aes(
label = glue::glue("{cond}: {round(draw)} [{round(.lower)}, {round(.upper)}]"),
x = 2250, y =reorder(study_label, draw), group = cond
),
size = 2, position = position_dodge(width = 0.75),
hjust = "inward"
) +
# Add individual study data
geom_point(
data = main_arm_data_effects |>
filter(!is.na(yi_mean)) |>
mutate(study_label = paste(authors, year)),
aes(x = yi_mean, y = study_label, color = cond),
size = 0.25,
# alpha = 0.5,
position = position_dodge(height = 0.5)
# position = position_dodge(width = 0.75),
# shape = "|"
) +
labs(
x = "Resting Energy Expenditure (kcal)",
title = "Conditional Estimates for Condition by Study"
) +
guides(
fill = "none",
color = "none"
) +
theme_bw() +
theme(axis.title.y = element_blank()) +
theme(title = element_text(size=8))
?position_dodge()
ggplot(study_pred, aes(x = draw,
y = reorder(study_label, mean_draw),
fill = cond)) +
stat_halfeye(slab_alpha = .5, point_size = 0.1, linewidth = 0.1,
position = position_dodge(width = 0.5), .width = 0.95) +
scale_fill_manual(values = c("#56B4E9", "#E69F00", "#009E73")) +
scale_color_manual(values = c("#56B4E9", "#E69F00", "#009E73")) +
geom_text(
data = mutate_if(study_labels,
is.numeric, round, 2),
aes(
label = glue::glue("{cond}: {round(draw)} [{round(.lower)}, {round(.upper)}]"),
x = 2250, y =reorder(study_label, draw), group = cond
),
size = 2, position = position_dodge(width = 0.75),
hjust = "inward"
) +
# Add individual study data
geom_point(
data = main_arm_data_effects |>
filter(!is.na(yi_mean)) |>
mutate(study_label = paste(authors, year)),
aes(x = yi_mean, y = study_label, color = cond),
size = 0.25,
# alpha = 0.5,
position = position_dodge(width = 0.75)
# position = position_dodge(width = 0.75),
# shape = "|"
) +
labs(
x = "Resting Energy Expenditure (kcal)",
title = "Conditional Estimates for Condition by Study"
) +
guides(
fill = "none",
color = "none"
) +
theme_bw() +
theme(axis.title.y = element_blank()) +
theme(title = element_text(size=8))
ggplot(study_pred, aes(x = draw,
y = reorder(study_label, mean_draw),
fill = cond)) +
stat_halfeye(slab_alpha = .5, point_size = 0.1, linewidth = 0.1,
position = position_dodge(width = 0.5), .width = 0.95) +
scale_fill_manual(values = c("#56B4E9", "#E69F00", "#009E73")) +
scale_color_manual(values = c("#56B4E9", "#E69F00", "#009E73")) +
geom_text(
data = mutate_if(study_labels,
is.numeric, round, 2),
aes(
label = glue::glue("{cond}: {round(draw)} [{round(.lower)}, {round(.upper)}]"),
x = 2250, y =reorder(study_label, draw), group = cond
),
size = 2, position = position_dodge(width = 0.75),
hjust = "inward"
) +
# Add individual study data
geom_point(
data = main_arm_data_effects |>
filter(!is.na(yi_mean)) |>
mutate(study_label = paste(authors, year)),
aes(x = yi_mean, y = study_label, color = cond),
size = 0.25,
# alpha = 0.5,
position = position_jitterdodge(dodge.width = 1, jitter.height = 0.1)
# position = position_dodge(width = 0.75),
# shape = "|"
) +
labs(
x = "Resting Energy Expenditure (kcal)",
title = "Conditional Estimates for Condition by Study"
) +
guides(
fill = "none",
color = "none"
) +
theme_bw() +
theme(axis.title.y = element_blank()) +
theme(title = element_text(size=8))
ggplot(study_pred, aes(x = draw,
y = reorder(study_label, mean_draw),
fill = cond)) +
stat_halfeye(slab_alpha = .5, point_size = 0.1, linewidth = 0.1,
position = position_dodge(width = 0.5), .width = 0.95) +
scale_fill_manual(values = c("#56B4E9", "#E69F00", "#009E73")) +
scale_color_manual(values = c("#56B4E9", "#E69F00", "#009E73")) +
geom_text(
data = mutate_if(study_labels,
is.numeric, round, 2),
aes(
label = glue::glue("{cond}: {round(draw)} [{round(.lower)}, {round(.upper)}]"),
x = 2250, y =reorder(study_label, draw), group = cond
),
size = 2, position = position_dodge(width = 0.75),
hjust = "inward"
) +
# Add individual study data
geom_point(
data = main_arm_data_effects |>
filter(!is.na(yi_mean)) |>
mutate(study_label = paste(authors, year)),
aes(x = yi_mean, y = study_label, color = cond),
size = 0.25,
alpha = 0.75,
position = position_jitterdodge(dodge.width = 1, jitter.height = 0.1)
# position = position_dodge(width = 0.75),
# shape = "|"
) +
labs(
x = "Resting Energy Expenditure (kcal)",
title = "Conditional Estimates for Condition by Study"
) +
guides(
fill = "none",
color = "none"
) +
theme_bw() +
theme(axis.title.y = element_blank()) +
theme(title = element_text(size=8))
targets::tar_make()
targets::tar_make()
targets::tar_make()
targets::tar_load(c(meta_mean_pred_plot,
meta_study_pred_plot,
meta_mean_contrast_plot))
meta_mean_pred_plot
meta_study_pred_plot
(study_pred_plot | (meta_pred_plot / contrast_plot)) +
plot_annotation(title = "Mean Resting Energy Expenditure",
caption = "Point estimates and 95% quantile intervals reported") +
plot_layout(guides = "collect", axis_titles = "collect",
# widths = c(2,1,1)
)  &
theme(axis.title.x = element_text(size=10),
legend.position = "bottom")
targets::tar_load(main_arm_data_effects)
targets::tar_make()
targets::tar_load(meta_mean_pred_plot,
meta_study_pred_plot,
meta_mean_contrast_plot)
targets::tar_load_globals(c(meta_mean_pred_plot,
meta_study_pred_plot,
meta_mean_contrast_plot))
targets::tar_load(c(meta_mean_pred_plot,
meta_study_pred_plot,
meta_mean_contrast_plot))
(meta_study_pred_plot | (meta_mean_pred_plot / meta_mean_contrast_plot)) +
plot_annotation(title = "Mean Resting Energy Expenditure",
caption = "Point estimates and 95% quantile intervals reported") +
plot_layout(guides = "collect", axis_titles = "collect",
# widths = c(2,1,1)
)  &
theme(axis.title.x = element_text(size=10),
legend.position = "bottom")
targets::tar_make()
tar_make()
tar_make()
tar_load(combined_mean_plot)
combined_mean_plot
tar_make()
tar_load(combined_mean_plot)
combined_mean_plot
tar_make()
tar_make()
tar_load(c(combined_mean_plot,))
tar_load(combined_variance_plot)
combined_variance_plot
tar_make()
tar_load(combined_variance_plot)
combined_variance_plot
tar_make()
tar_load(combined_variance_plot)
combined_variance_plot
tar_make()
tar_load(combined_variance_plot)
combined_variance_plot
combined_mean_plot
tar_load(main_arm_data)
glimpse(main_arm_data)
main_arm_data |> select(lab, study, arm, authors, year, n, mean, sd) |>
main_arm_data |> select(lab, study, arm, authors, year, cond, n, mean, sd) |>
pivot_wider(names_from = "cond", values_from = c("n","mean", "sd"))
main_arm_data |> filter(timepoint == "baseline") |> select(lab, study, arm, authors, year, cond, n, mean, sd) |>
pivot_wider(names_from = "cond", values_from = c("n","mean", "sd"))
wide_data <- main_arm_data |>
filter(timepoint == "baseline") |>
select(lab, study, arm, authors, year, cond, n, mean, sd) |>
pivot_wider(names_from = "cond", values_from = c("n","mean", "sd"))
View(wide_data)
wide_data <- main_arm_data |>
filter(timepoint == "baseline") |>
select(lab, study, authors, year, cond, n, mean, sd) |>
pivot_wider(names_from = "cond", values_from = c("n","mean", "sd"))
View(wide_data)
wide_data <- main_arm_data |>
filter(timepoint == "baseline") |>
select(lab, study, authors, year, cond, n, mean, sd) |>
pivot_wider(names_from = "cond", values_from = c("n","mean", "sd")) |>
filter(map_lgl(n_PCOS, ~ length(.x) == 1) &
map_lgl(n_Control, ~ length(.x) == 1))
wide_data
wide_data <- escalc(measure = "MD",
m1i = mean_PCOS,
m2i = mean_CONT,
sd1i = sd_PCOS,
sd2i = sd_CONT,
n1i = n_PCOS,
n2i = n_CONT,
data = wide_data,
var.names = c("yi_mean", "vi_mean"))
wide_data <- escalc(measure = "MD",
m1i = mean_PCOS,
m2i = mean_Control,
sd1i = sd_PCOS,
sd2i = sd_Control,
n1i = n_PCOS,
n2i = n_Control,
data = wide_data,
var.names = c("yi_mean", "vi_mean"))
wide_data <- main_arm_data |>
filter(timepoint == "baseline") |>
select(lab, study, authors, year, cond, n, mean, sd) |>
pivot_wider(names_from = "cond", values_from = c("n","mean", "sd")) |>
filter(map_lgl(n_PCOS, ~ length(.x) == 1) &
map_lgl(n_Control, ~ length(.x) == 1)) |>
mutate(across(n_PCOS:sd_Control, as.numeric))
wide_data <- escalc(measure = "MD",
m1i = mean_PCOS,
m2i = mean_Control,
sd1i = sd_PCOS,
sd2i = sd_Control,
n1i = n_PCOS,
n2i = n_Control,
data = wide_data,
var.names = c("yi_mean", "vi_mean"))
wide_data <- escalc(measure = "CVR",
m1i = mean_PCOS,
m2i = mean_Control,
sd1i = sd_PCOS,
sd2i = sd_Control,
n1i = n_PCOS,
n2i = n_Control,
data = wide_data,
var.names = c("yi_cvr", "vi_cvr"))
wide_data
pairwise_model <- brm(yi_mean | se(sqrt(vi_mean)) ~ 1 + (1 | study) + (1 | arm),
data = wide_data,
chains = 4,
cores = 4,
seed = 1988,
warmup = 2000,
iter = 8000)
pairwise_model <- brm(yi_mean | se(sqrt(vi_mean)) ~ 1 + (1 | lab) + (1 | study),
data = wide_data,
chains = 4,
cores = 4,
seed = 1988,
warmup = 2000,
iter = 8000)
pairwise_model
brm(yi_cvr | se(sqrt(vi_cvr)) ~ 1 + (1 | lab) + (1 | study),
data = wide_data,
chains = 4,
cores = 4,
seed = 1988,
warmup = 2000,
iter = 8000)
exp(0.11)
exp(-0.11)
targets::tar_make()
tar_make()
tar_load(c(pairwise_mean_effects_model, pairwise_variance_effects_model, main_arm_mean_effects_model, main_arm_variance_effects_model))
pairwise_mean_effects_model
main_arm_mean_effects_model
tar_load(main_arm_data)
main_arm_data |> group_by(arm) |> slice_head(n=1) |> ungroup() |> group_by(cond, insulin_resistant_y_n) |> count()
insulin_r <- main_arm_data |> filter(insulin_resistant_y_n == "y")
View(insulin_r)
insulin_r_n <- main_arm_data |> filter(insulin_resistant_y_n == "n")
View(insulin_r_n)
main_arm_mean_effects_model
pairwise_mean_effects_model
tar_load(combined_variance_plots)
tar_load(combined_variance_plot)
combined_variance_plot
pairwise_variance_effects_model
exp(-0.11)
exp(-0.51)
exp(0.3)
targets::tar_load(combined_mean_plot)
targets::tar_load(combined_variance_plot)
combined_mean_plot
combined_variance_plot
targets::tar_visnetwork()
targets::tar_make()
targets::tar_make()
targets::tar_make()
targets::tar_make()
targets::tar_make()
ggplot2::geom_text()
?ggplot2::geom_text()
targets::tar_make()
targets::tar_make()
targets::tar_make()
targets::tar_make()
targets::tar_make()
targets::tar_make()
install.packages("equatiomatic")
targets::tar_load(c(
main_arm_data_effects,
pairwise_data_effects
))
install.packages("lme4")
library(lme4)
model <- lmer(yi_mean |  ~ 0 + Intercept + cond + (1 + cond | lab) + (1 + cond | study) + (1 | arm),
data=main_arm_data_effects)
model <- lmer(yi_mean  ~ 0 + Intercept + cond + (1 + cond | lab) + (1 + cond | study) + (1 | arm),
data=main_arm_data_effects)
model <- lmer(yi_mean  ~ 1 + cond + (1 + cond | lab) + (1 + cond | study) + (1 | arm),
data=main_arm_data_effects)
equatiomatic::extract_eq(model)
library(equatiomatic)
targets::tar_load(c(pairwise_mean_effects_model, pairwise_variance_effects_model))
targets::tar_load(c(main_arm_mean_effects_model,main_arm_variance_effects_model))
brms::get_prior(main_arm_mean_effects_model)
brms::get_prior(main_arm_variance_effects_model)
library(tidyverse)
main_arm_data_effects |>
rowid_to_column("effect")
targets::tar_make()
targets::tar_load(main_arm_mean_effects_model)
targets::tar_load(main_arm_variance_effects_model)
plot(main_arm_mean_effects_model)
brms::pp_check(main_arm_mean_effects_model)
plot(main_arm_variance_effects_model)
brms::pp_check(main_arm_variance_effects_model)
library(brms)
pp_check(main_arm_variance_effects_model)
